{"ast":null,"code":"var _s = $RefreshSig$();\nimport axios from \"axios\";\nimport dayjs from \"dayjs\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { useUserContext } from \"../contexts/AuthContext\";\nconst axiosPrivate = axios.create({\n  baseURL: \"http://localhost:3000\",\n  withCredentials: true\n});\nconst useAxiosPrivate = () => {\n  _s();\n  const {\n    accessToken,\n    refresh\n  } = useUserContext();\n  axiosPrivate.interceptors.request.use(async req => {\n    if (!accessToken) refresh();\n    const user = jwtDecode(accessToken);\n    const isExpired = dayjs.unix(user.exp).diff(dayjs()) < 1;\n    console.log(\"expiration\", isExpired);\n    if (!isExpired) return req;\n    refresh();\n    console.log(\"ici\");\n    return req;\n  });\n  return axiosPrivate;\n};\n_s(useAxiosPrivate, \"h0mhQv/zLyVBn8ty1JwfNmlgPcw=\", false, function () {\n  return [useUserContext];\n});\nexport default useAxiosPrivate;","map":{"version":3,"names":["axios","dayjs","jwtDecode","useUserContext","axiosPrivate","create","baseURL","withCredentials","useAxiosPrivate","_s","accessToken","refresh","interceptors","request","use","req","user","isExpired","unix","exp","diff","console","log"],"sources":["C:/Users/mereb/Documents/git_repos/TipTap/TipTap/frontend/tiptap/src/hooks/useAxiosPrivate.js"],"sourcesContent":["import axios from \"axios\";\r\nimport dayjs from \"dayjs\";\r\nimport { jwtDecode } from \"jwt-decode\";\r\nimport { useUserContext } from \"../contexts/AuthContext\";\r\nconst axiosPrivate = axios.create({\r\n  baseURL: \"http://localhost:3000\",\r\n  withCredentials: true,\r\n});\r\n\r\nconst useAxiosPrivate = () => {\r\n  const { accessToken, refresh } = useUserContext();\r\n\r\n  axiosPrivate.interceptors.request.use(async (req) => {\r\n    if (!accessToken) refresh();\r\n    const user = jwtDecode(accessToken);\r\n    const isExpired = dayjs.unix(user.exp).diff(dayjs()) < 1;\r\n\r\n    console.log(\"expiration\", isExpired);\r\n\r\n    if (!isExpired) return req;\r\n\r\n    refresh();\r\n\r\n    console.log(\"ici\");\r\n\r\n    return req;\r\n  });\r\n\r\n  return axiosPrivate;\r\n};\r\n\r\nexport default useAxiosPrivate;\r\n"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,QAAQ,YAAY;AACtC,SAASC,cAAc,QAAQ,yBAAyB;AACxD,MAAMC,YAAY,GAAGJ,KAAK,CAACK,MAAM,CAAC;EAChCC,OAAO,EAAE,uBAAuB;EAChCC,eAAe,EAAE;AACnB,CAAC,CAAC;AAEF,MAAMC,eAAe,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC5B,MAAM;IAAEC,WAAW;IAAEC;EAAQ,CAAC,GAAGR,cAAc,CAAC,CAAC;EAEjDC,YAAY,CAACQ,YAAY,CAACC,OAAO,CAACC,GAAG,CAAC,MAAOC,GAAG,IAAK;IACnD,IAAI,CAACL,WAAW,EAAEC,OAAO,CAAC,CAAC;IAC3B,MAAMK,IAAI,GAAGd,SAAS,CAACQ,WAAW,CAAC;IACnC,MAAMO,SAAS,GAAGhB,KAAK,CAACiB,IAAI,CAACF,IAAI,CAACG,GAAG,CAAC,CAACC,IAAI,CAACnB,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC;IAExDoB,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEL,SAAS,CAAC;IAEpC,IAAI,CAACA,SAAS,EAAE,OAAOF,GAAG;IAE1BJ,OAAO,CAAC,CAAC;IAETU,OAAO,CAACC,GAAG,CAAC,KAAK,CAAC;IAElB,OAAOP,GAAG;EACZ,CAAC,CAAC;EAEF,OAAOX,YAAY;AACrB,CAAC;AAACK,EAAA,CApBID,eAAe;EAAA,QACcL,cAAc;AAAA;AAqBjD,eAAeK,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}